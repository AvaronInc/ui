
import { useState, useEffect } from 'react';
import { Bug, Globe, Code, Server, Database, Shield, AlertTriangle, Monitor } from 'lucide-react';
import React from 'react';

interface Exploit {
  id: string;
  cve: string;
  title: string;
  description: string;
  severity: 'critical' | 'high' | 'medium' | 'low';
  category: string;
  published: string;
  affectedSystems: string[];
  usedByApts: string[];
  mitigationAvailable: boolean;
}

interface Category {
  id: string;
  name: string;
  description: string;
  icon: React.ReactNode;
}

export const useExploitData = () => {
  const [categories] = useState<Category[]>([
    {
      id: 'rce',
      name: 'Remote Code Execution',
      description: 'Vulnerabilities that allow attackers to execute arbitrary code remotely',
      icon: <Code className="h-4 w-4" />
    },
    {
      id: 'sqli',
      name: 'SQL Injection',
      description: 'Vulnerabilities that allow attackers to inject and execute SQL commands',
      icon: <Database className="h-4 w-4" />
    },
    {
      id: 'xss',
      name: 'Cross-Site Scripting',
      description: 'Vulnerabilities that allow attackers to inject client-side scripts',
      icon: <Globe className="h-4 w-4" />
    },
    {
      id: 'privesc',
      name: 'Privilege Escalation',
      description: 'Vulnerabilities that allow attackers to gain elevated access',
      icon: <Shield className="h-4 w-4" />
    },
    {
      id: 'dos',
      name: 'Denial of Service',
      description: 'Vulnerabilities that allow attackers to make resources unavailable',
      icon: <AlertTriangle className="h-4 w-4" />
    },
    {
      id: 'infoleak',
      name: 'Information Disclosure',
      description: 'Vulnerabilities that expose sensitive information',
      icon: <Monitor className="h-4 w-4" />
    },
    {
      id: 'auth',
      name: 'Authentication Bypass',
      description: 'Vulnerabilities that allow attackers to bypass authentication mechanisms',
      icon: <Bug className="h-4 w-4" />
    },
    {
      id: 'network',
      name: 'Network Security',
      description: 'Vulnerabilities in network protocols and services',
      icon: <Server className="h-4 w-4" />
    }
  ]);
  
  const [exploits] = useState<Exploit[]>([
    {
      id: 'exploit-1',
      cve: 'CVE-2023-23397',
      title: 'Microsoft Outlook Elevation of Privilege Vulnerability',
      description: 'This vulnerability allows an attacker to send a message with an extended MAPI property containing a UNC path to an SMB server under their control, which will cause the target device to authenticate to the attacker\'s server, potentially leaking the Net-NTLMv2 hash.',
      severity: 'critical',
      category: 'privesc',
      published: '2023-03-14',
      affectedSystems: ['Microsoft Outlook', 'Microsoft 365 Apps'],
      usedByApts: ['APT28', 'APT41'],
      mitigationAvailable: true
    },
    {
      id: 'exploit-2',
      cve: 'CVE-2023-28252',
      title: 'Windows Common Log File System Driver Elevation of Privilege Vulnerability',
      description: 'This vulnerability could allow a local attacker to gain SYSTEM privileges. This vulnerability is being actively exploited.',
      severity: 'critical',
      category: 'privesc',
      published: '2023-04-11',
      affectedSystems: ['Windows 10', 'Windows 11', 'Windows Server'],
      usedByApts: ['APT29', 'MuddyWater'],
      mitigationAvailable: true
    },
    {
      id: 'exploit-3',
      cve: 'CVE-2023-3519',
      title: 'Citrix ADC and Gateway Authentication Bypass',
      description: 'This critical vulnerability in Citrix ADC and Gateway can allow unauthenticated attackers to execute arbitrary code remotely on affected systems.',
      severity: 'critical',
      category: 'auth',
      published: '2023-07-18',
      affectedSystems: ['Citrix ADC', 'Citrix Gateway'],
      usedByApts: ['APT41', 'Dragonfly'],
      mitigationAvailable: true
    },
    {
      id: 'exploit-4',
      cve: 'CVE-2023-20198',
      title: 'Cisco IOS XE Web UI Privilege Escalation',
      description: 'This vulnerability in the Cisco IOS XE web UI could allow an unauthenticated, remote attacker to create an account with privilege level 15 access.',
      severity: 'critical',
      category: 'privesc',
      published: '2023-10-16',
      affectedSystems: ['Cisco IOS XE'],
      usedByApts: ['APT41'],
      mitigationAvailable: true
    },
    {
      id: 'exploit-5',
      cve: 'CVE-2023-0669',
      title: 'GoAnywhere MFT Remote Code Execution',
      description: 'A vulnerability in GoAnywhere MFT allows attackers to create an initial admin user and gain remote code execution via the License Response servlet.',
      severity: 'critical',
      category: 'rce',
      published: '2023-02-02',
      affectedSystems: ['GoAnywhere MFT'],
      usedByApts: ['APT28'],
      mitigationAvailable: true
    },
    {
      id: 'exploit-6',
      cve: 'CVE-2022-22965',
      title: 'Spring Framework RCE (Spring4Shell)',
      description: 'A vulnerability in the Spring Framework allows remote attackers to execute arbitrary code by crafting a special HTTP request.',
      severity: 'high',
      category: 'rce',
      published: '2022-03-31',
      affectedSystems: ['Spring Core', 'Spring Framework', 'Java Applications'],
      usedByApts: ['APT41', 'Dragonfly'],
      mitigationAvailable: true
    },
    {
      id: 'exploit-7',
      cve: 'CVE-2022-26134',
      title: 'Atlassian Confluence Server OGNL Injection',
      description: 'A critical vulnerability in Atlassian Confluence Server and Data Center allows unauthenticated attackers to execute arbitrary code via OGNL injection.',
      severity: 'critical',
      category: 'rce',
      published: '2022-06-02',
      affectedSystems: ['Atlassian Confluence Server', 'Atlassian Confluence Data Center'],
      usedByApts: ['APT41', 'APT10'],
      mitigationAvailable: true
    },
    {
      id: 'exploit-8',
      cve: 'CVE-2021-44228',
      title: 'Log4j Remote Code Execution (Log4Shell)',
      description: 'A critical vulnerability in Apache Log4j allows attackers to execute arbitrary code by sending a specially crafted request that uses JNDI lookup features.',
      severity: 'critical',
      category: 'rce',
      published: '2021-12-10',
      affectedSystems: ['Apache Log4j', 'Java Applications'],
      usedByApts: ['APT41', 'APT10', 'APT29', 'APT33', 'Dragonfly'],
      mitigationAvailable: true
    },
    {
      id: 'exploit-9',
      cve: 'CVE-2021-40539',
      title: 'Zoho ManageEngine ADSelfService Plus Authentication Bypass',
      description: 'A critical vulnerability in Zoho ManageEngine ADSelfService Plus allows attackers to bypass authentication and execute arbitrary code.',
      severity: 'critical',
      category: 'auth',
      published: '2021-09-07',
      affectedSystems: ['Zoho ManageEngine ADSelfService Plus'],
      usedByApts: ['APT28', 'APT10'],
      mitigationAvailable: true
    },
    {
      id: 'exploit-10',
      cve: 'CVE-2023-22809',
      title: 'Sudo Policy Bypass Vulnerability',
      description: 'A vulnerability in Sudo allows a local attacker to bypass some policy restrictions and execute commands as root when sudoedit is allowed.',
      severity: 'high',
      category: 'privesc',
      published: '2023-01-19',
      affectedSystems: ['Unix/Linux systems', 'macOS'],
      usedByApts: [],
      mitigationAvailable: true
    },
    {
      id: 'exploit-11',
      cve: 'CVE-2023-21839',
      title: 'Oracle WebLogic Server Vulnerability',
      description: 'This vulnerability in Oracle WebLogic Server allows unauthenticated attackers with network access to compromise the system.',
      severity: 'high',
      category: 'rce',
      published: '2023-01-17',
      affectedSystems: ['Oracle WebLogic Server'],
      usedByApts: ['APT41', 'APT10'],
      mitigationAvailable: true
    },
    {
      id: 'exploit-12',
      cve: 'CVE-2023-25610',
      title: 'Apache OFBiz Authentication Bypass',
      description: 'A vulnerability in Apache OFBiz XML-RPC handler allows remote attackers to bypass authentication and execute arbitrary code.',
      severity: 'critical',
      category: 'auth',
      published: '2023-02-22',
      affectedSystems: ['Apache OFBiz'],
      usedByApts: [],
      mitigationAvailable: true
    },
    {
      id: 'exploit-13',
      cve: 'CVE-2022-41034',
      title: 'Microsoft SharePoint Server Elevation of Privilege',
      description: 'An elevation of privilege vulnerability in Microsoft SharePoint Server may allow attackers to run arbitrary code in the security context of the SharePoint application pool.',
      severity: 'medium',
      category: 'privesc',
      published: '2022-10-11',
      affectedSystems: ['Microsoft SharePoint Server'],
      usedByApts: ['APT29'],
      mitigationAvailable: true
    },
    {
      id: 'exploit-14',
      cve: 'CVE-2022-27518',
      title: 'Citrix Gateway and ADC Authentication Bypass',
      description: 'A vulnerability in Citrix ADC and Gateway allows unauthenticated, remote attacks on Citrix Gateway SAML deployments.',
      severity: 'critical',
      category: 'auth',
      published: '2022-12-13',
      affectedSystems: ['Citrix ADC', 'Citrix Gateway'],
      usedByApts: ['APT10', 'APT41'],
      mitigationAvailable: true
    },
    {
      id: 'exploit-15',
      cve: 'CVE-2023-36884',
      title: 'Microsoft Office and Windows Search RCE',
      description: 'A vulnerability in Microsoft Office and Windows Search could allow attackers to execute remote code execution via a crafted file.',
      severity: 'high',
      category: 'rce',
      published: '2023-07-11',
      affectedSystems: ['Microsoft Office', 'Windows Search'],
      usedByApts: ['APT28'],
      mitigationAvailable: true
    }
  ]);
  
  // Get years for filtering
  const years = [...new Set(exploits.map(exploit => new Date(exploit.published).getFullYear()))].sort((a, b) => b - a);
  
  // Simulate fetching data
  useEffect(() => {
    // In a real implementation, we'd fetch data from an API
    // For this sample, we're using static data
    console.log('Fetched exploit data');
  }, []);
  
  return { exploits, categories, years };
};
